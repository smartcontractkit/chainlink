# Tools for configuring Functions DON

Kudos to VRF team for inspiration.

## Usage

1. Create a hidden file containing nodes list: hosts, logins and passwords. 
It is a simple text file, where each row has the following structure:

```
boot_node_url login password
node0_url login0 password0
node1_url login1 password1
...
```

Note: the single *bootstrap* node must go first. To support multiple bootstrap nodes, alter the tool.

Preparing such a file is the only "manual" step that is required. 

2. Review `/templates`

This sub-folder contains two `toml` templates that will be processed with `generate-jobspecs` command.

2. Run the tool: `go run .` to see available commands.

Initial set of commands:
* `generate-ocr2config` generates `FunctionsOracleConfig.json` that is consumed by contracts tooling.
* `generate-jobspecs` generates Job Specs (toml) for each node based on its role.
* `deploy-jobspecs` deploys Job Specs generated by `generate-jobspec` to all the nodes.

All generated artefacts are saved in `artefacts` sub-directory.

Each command has its own parameters. Simply run a command without parameters to see usage.

4. Common caveats

* The current implementation expects a single bootstrap node and a few oracle nodes.
Bootstrap node must come first in the nodes list file.
* You may or may not specify `https://` prefix for hosts, the tool will handle this.
* Any command would terminate immediately with the first issue detected.
* `deploy-jobspecs` command does NOT check for the existing jobs, be careful.
* `deploy-jobspecs` command does not deploy bridges, they should exist prior to execution.
* The tooling does not interact with chains/contracts.

5. Future enhancements

* Add `deploy-bridges` command.
* For NOPs: make commands to run against a single node with terminal authorization.
* For NOPs: make sure we can inject their node config from a file.

