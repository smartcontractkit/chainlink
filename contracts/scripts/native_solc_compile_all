#!/usr/bin/env bash

set -e

SCRIPTPATH="$( cd "$(dirname "$0")" >/dev/null 2>&1 ; pwd -P )"
echo $SCRIPTPATH
python3 -m pip install --require-hashes -r $SCRIPTPATH/requirements.txt
solc-select install 0.6.6
solc-select install 0.7.6
solc-select install 0.8.6
solc-select install 0.8.15
solc-select install 0.8.16
solc-select install 0.8.19

$SCRIPTPATH/native_solc6_compile Flags.sol
$SCRIPTPATH/native_solc6_compile Oracle.sol
$SCRIPTPATH/native_solc6_compile FluxAggregator.sol
$SCRIPTPATH/native_solc6_compile VRF.sol
$SCRIPTPATH/native_solc6_compile VRFCoordinator.sol
$SCRIPTPATH/native_solc6_compile tests/VRFRequestIDBaseTestHelper.sol
$SCRIPTPATH/native_solc6_compile tests/VRFTestHelper.sol
$SCRIPTPATH/native_solc6_compile Chainlink.sol
$SCRIPTPATH/native_solc6_compile VRFRequestIDBase.sol
$SCRIPTPATH/native_solc6_compile tests/VRFConsumer.sol
$SCRIPTPATH/native_solc6_compile ChainlinkClient.sol
$SCRIPTPATH/native_solc6_compile VRFConsumerBase.sol
$SCRIPTPATH/native_solc6_compile BlockhashStore.sol
$SCRIPTPATH/native_solc6_compile tests/TestAPIConsumer.sol
$SCRIPTPATH/native_solc6_compile tests/MockETHLINKAggregator.sol
$SCRIPTPATH/native_solc6_compile tests/MockGASAggregator.sol

$SCRIPTPATH/native_solc7_compile tests/MultiWordConsumer.sol
$SCRIPTPATH/native_solc7_compile Operator.sol
$SCRIPTPATH/native_solc7_compile AuthorizedForwarder.sol
$SCRIPTPATH/native_solc7_compile AuthorizedReceiver.sol
$SCRIPTPATH/native_solc7_compile OperatorFactory.sol
$SCRIPTPATH/native_solc7_compile tests/Consumer.sol
$SCRIPTPATH/native_solc7_compile tests/VRFCoordinatorMock.sol

# Keeper
$SCRIPTPATH/native_solc7_compile KeeperRegistry1_1.sol
$SCRIPTPATH/native_solc7_compile UpkeepRegistrationRequests.sol
$SCRIPTPATH/native_solc7_compile tests/UpkeepPerformCounterRestrictive.sol
$SCRIPTPATH/native_solc7_compile tests/UpkeepCounter.sol

$SCRIPTPATH/native_solc8_6_compile automation/upkeeps/CronUpkeepFactory.sol
$SCRIPTPATH/native_solc8_6_compile automation/1_2/KeeperRegistrar1_2.sol
$SCRIPTPATH/native_solc8_6_compile automation/1_2/KeeperRegistry1_2.sol
$SCRIPTPATH/native_solc8_6_compile automation/1_2/KeeperRegistryCheckUpkeepGasUsageWrapper1_2.sol
$SCRIPTPATH/native_solc8_6_compile automation/1_3/KeeperRegistry1_3.sol
$SCRIPTPATH/native_solc8_6_compile automation/1_3/KeeperRegistryLogic1_3.sol
$SCRIPTPATH/native_solc8_6_compile automation/2_0/KeeperRegistrar2_0.sol
$SCRIPTPATH/native_solc8_6_compile automation/2_0/KeeperRegistry2_0.sol
$SCRIPTPATH/native_solc8_6_compile automation/2_0/KeeperRegistryLogic2_0.sol
$SCRIPTPATH/native_solc8_6_compile automation/UpkeepTranscoder.sol
$SCRIPTPATH/native_solc8_6_compile automation/mocks/MockAggregatorProxy.sol
$SCRIPTPATH/native_solc8_6_compile dev/automation/tests/LogUpkeepCounter.sol

$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/AutomationRegistrar2_1.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/KeeperRegistry2_1.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/KeeperRegistryLogicA2_1.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/KeeperRegistryLogicB2_1.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/interfaces/IKeeperRegistryMaster.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/interfaces/ILogAutomation.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/AutomationUtils2_1.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/2_1/AutomationForwarderLogic.sol
$SCRIPTPATH/native_solc8_16_compile dev/automation/tests/LogTriggeredFeedLookup.sol
$SCRIPTPATH/native_solc8_15_compile dev/automation/2_1/interfaces/FeedLookupCompatibleInterface.sol

$SCRIPTPATH/native_solc8_16_compile tests/VerifiableLoadUpkeep.sol
$SCRIPTPATH/native_solc8_16_compile tests/VerifiableLoadMercuryUpkeep.sol
$SCRIPTPATH/native_solc8_16_compile tests/VerifiableLoadLogTriggerUpkeep.sol
$SCRIPTPATH/native_solc8_15_compile tests/MercuryUpkeep.sol
$SCRIPTPATH/native_solc8_16_compile tests/AutomationConsumerBenchmark.sol

# Aggregators
$SCRIPTPATH/native_solc8_6_compile interfaces/AggregatorV2V3Interface.sol
$SCRIPTPATH/native_solc8_6_compile Chainlink.sol
$SCRIPTPATH/native_solc8_6_compile ChainlinkClient.sol

# Keepers x VRF v2
$SCRIPTPATH/native_solc8_6_compile KeepersVRFConsumer.sol

# Feeds
$SCRIPTPATH/native_solc8_6_compile dev/DerivedPriceFeed.sol

# Log tester
$SCRIPTPATH/native_solc8_6_compile tests/LogEmitter.sol

# Chainlink Functions
$SCRIPTPATH/native_solc_compile_all_functions

# llo-feeds
$SCRIPTPATH/native_solc_compile_all_llo

# Mocks
$SCRIPTPATH/native_solc8_6_compile mocks/FunctionsOracleEventsMock.sol
$SCRIPTPATH/native_solc8_6_compile mocks/FunctionsBillingRegistryEventsMock.sol

# Transmission
$SCRIPTPATH/native_solc_compile_all_transmission

# VRF
$SCRIPTPATH/native_solc_compile_all_vrf
